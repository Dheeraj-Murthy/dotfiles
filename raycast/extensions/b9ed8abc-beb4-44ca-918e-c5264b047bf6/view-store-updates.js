"use strict";var Ge=Object.create;var se=Object.defineProperty;var He=Object.getOwnPropertyDescriptor;var Ke=Object.getOwnPropertyNames;var Je=Object.getPrototypeOf,Ze=Object.prototype.hasOwnProperty;var qe=(e,n)=>{for(var r in n)se(e,r,{get:n[r],enumerable:!0})},ke=(e,n,r,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of Ke(n))!Ze.call(e,i)&&i!==r&&se(e,i,{get:()=>n[i],enumerable:!(t=He(n,i))||t.enumerable});return e};var oe=(e,n,r)=>(r=e!=null?Ge(Je(e)):{},ke(n||!e||!e.__esModule?se(r,"default",{value:e,enumerable:!0}):r,e)),Ye=e=>ke(se({},"__esModule",{value:!0}),e);var kt={};qe(kt,{default:()=>Be});module.exports=Ye(kt);var E=require("@raycast/api");var d=oe(require("react")),w=require("@raycast/api");var xe=Object.prototype.hasOwnProperty;function ie(e,n){var r,t;if(e===n)return!0;if(e&&n&&(r=e.constructor)===n.constructor){if(r===Date)return e.getTime()===n.getTime();if(r===RegExp)return e.toString()===n.toString();if(r===Array){if((t=e.length)===n.length)for(;t--&&ie(e[t],n[t]););return t===-1}if(!r||typeof e=="object"){t=0;for(r in e)if(xe.call(e,r)&&++t&&!xe.call(n,r)||!(r in n)||!ie(e[r],n[r]))return!1;return Object.keys(n).length===t}}return e!==e&&n!==n}var X=oe(require("node:fs")),le=oe(require("node:path")),Ce=oe(require("node:crypto"));var Ae=require("react/jsx-runtime");function Xe(e){let n=(0,d.useRef)(e),r=(0,d.useRef)(0);return ie(e,n.current)||(n.current=e,r.current+=1),(0,d.useMemo)(()=>n.current,[r.current])}function _(e){let n=(0,d.useRef)(e);return n.current=e,n}function Qe(e,n){let r=e instanceof Error?e.message:String(e);return(0,w.showToast)({style:w.Toast.Style.Failure,title:n?.title??"Something went wrong",message:n?.message??r,primaryAction:n?.primaryAction??Se(e),secondaryAction:n?.primaryAction?Se(e):void 0})}var Se=e=>{let n=!0,r="[Extension Name]...",t="";try{let s=JSON.parse((0,X.readFileSync)((0,le.join)(w.environment.assetsPath,"..","package.json"),"utf8"));r=`[${s.title}]...`,t=`https://raycast.com/${s.owner||s.author}/${s.name}`,(!s.owner||s.access==="public")&&(n=!1)}catch{}let i=w.environment.isDevelopment||n,c=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:i?"Copy Logs":"Report Error",onAction(s){s.hide(),i?w.Clipboard.copy(c):(0,w.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(t)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${c}
\`\`\`
`)}`)}}};function et(e,n,r){let t=(0,d.useRef)(0),[i,c]=(0,d.useState)({isLoading:!0}),s=_(e),a=_(r?.abortable),o=_(n||[]),f=_(r?.onError),p=_(r?.onData),u=_(r?.onWillExecute),g=_(r?.failureToastOptions),$=_(i.data),y=(0,d.useRef)(null),b=(0,d.useRef)({page:0}),S=(0,d.useRef)(!1),I=(0,d.useRef)(!0),D=(0,d.useRef)(50),v=(0,d.useCallback)(()=>(a.current&&(a.current.current?.abort(),a.current.current=new AbortController),++t.current),[a]),k=(0,d.useCallback)((...F)=>{let T=v();u.current?.(F),c(l=>({...l,isLoading:!0}));let H=tt(s.current)(...F);function K(l){return l.name=="AbortError"||T===t.current&&(f.current?f.current(l):w.environment.launchType!==w.LaunchType.Background&&Qe(l,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(h){h.hide(),y.current?.(...o.current||[])}},...g.current}),c({error:l,isLoading:!1})),l}return typeof H=="function"?(S.current=!0,H(b.current).then(({data:l,hasMore:h,cursor:W})=>(T===t.current&&(b.current&&(b.current.cursor=W,b.current.lastItem=l?.[l.length-1]),p.current&&p.current(l,b.current),h&&(D.current=l.length),I.current=h,c(J=>b.current.page===0?{data:l,isLoading:!1}:{data:(J.data||[])?.concat(l),isLoading:!1})),l),l=>(I.current=!1,K(l)))):(S.current=!1,H.then(l=>(T===t.current&&(p.current&&p.current(l),c({data:l,isLoading:!1})),l),K))},[p,f,o,s,c,y,u,b,g,v]);y.current=k;let P=(0,d.useCallback)(()=>{b.current={page:0};let F=o.current||[];return k(...F)},[k,o]),M=(0,d.useCallback)(async(F,T)=>{let H;try{if(T?.optimisticUpdate){v(),typeof T?.rollbackOnError!="function"&&T?.rollbackOnError!==!1&&(H=structuredClone($.current?.value));let K=T.optimisticUpdate;c(l=>({...l,data:K(l.data)}))}return await F}catch(K){if(typeof T?.rollbackOnError=="function"){let l=T.rollbackOnError;c(h=>({...h,data:l(h.data)}))}else T?.optimisticUpdate&&T?.rollbackOnError!==!1&&c(l=>({...l,data:H}));throw K}finally{T?.shouldRevalidateAfter!==!1&&(w.environment.launchType===w.LaunchType.Background||w.environment.commandMode==="menu-bar"?await P():P())}},[P,$,c,v]),N=(0,d.useCallback)(()=>{b.current.page+=1;let F=o.current||[];k(...F)},[b,o,k]);(0,d.useEffect)(()=>{b.current={page:0},r?.execute!==!1?k(...n||[]):v()},[Xe([n,r?.execute,k]),a,b]),(0,d.useEffect)(()=>()=>{v()},[v]);let q=r?.execute!==!1?i.isLoading:!1,Y={...i,isLoading:q},ee=S.current?{pageSize:D.current,hasMore:I.current,onLoadMore:N}:void 0;return{...Y,revalidate:P,mutate:M,pagination:ee}}function tt(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}function ve(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))!==null}function rt(e){return e instanceof URLSearchParams?e.toString():e}function Re(e,n=[]){function r(t){return"update"in e?e.update(t,"utf8"):e.write(t)}return{dispatch:function(t){t=rt(t),t===null?this._null():this["_"+typeof t](t)},_object:function(t){let i=/\[object (.*)\]/i,c=Object.prototype.toString.call(t),s=i.exec(c)?.[1]??"unknown:["+c+"]";s=s.toLowerCase();let a=null;if((a=n.indexOf(t))>=0){this.dispatch("[CIRCULAR:"+a+"]");return}else n.push(t);if(Buffer.isBuffer(t))return r("buffer:"),r(t.toString("utf8"));if(s!=="object"&&s!=="function"&&s!=="asyncfunction")if(this["_"+s])this["_"+s](t);else throw new Error('Unknown object type "'+s+'"');else{let o=Object.keys(t);o=o.sort(),ve(t)||o.splice(0,0,"prototype","__proto__","constructor"),r("object:"+o.length+":");let f=this;return o.forEach(function(p){f.dispatch(p),r(":"),f.dispatch(t[p]),r(",")})}},_array:function(t,i){i=typeof i<"u"?i:!1;let c=this;if(r("array:"+t.length+":"),!i||t.length<=1){t.forEach(function(o){c.dispatch(o)});return}let s=[],a=t.map(function(o){let f=nt(),p=n.slice();return Re(f,p).dispatch(o),s=s.concat(p.slice(n.length)),f.read().toString()});n=n.concat(s),a.sort(),this._array(a,!1)},_date:function(t){r("date:"+t.toJSON())},_symbol:function(t){r("symbol:"+t.toString())},_error:function(t){r("error:"+t.toString())},_boolean:function(t){r("bool:"+t.toString())},_string:function(t){r("string:"+t.length+":"),r(t.toString())},_function:function(t){r("fn:"),ve(t)?this.dispatch("[native]"):this.dispatch(t.toString()),this.dispatch("function-name:"+String(t.name)),this._object(t)},_number:function(t){r("number:"+t.toString())},_xml:function(t){r("xml:"+t.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(t){r("regex:"+t.toString())},_uint8array:function(t){r("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint8clampedarray:function(t){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},_int8array:function(t){r("int8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint16array:function(t){r("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},_int16array:function(t){r("int16array:"),this.dispatch(Array.prototype.slice.call(t))},_uint32array:function(t){r("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},_int32array:function(t){r("int32array:"),this.dispatch(Array.prototype.slice.call(t))},_float32array:function(t){r("float32array:"),this.dispatch(Array.prototype.slice.call(t))},_float64array:function(t){r("float64array:"),this.dispatch(Array.prototype.slice.call(t))},_arraybuffer:function(t){r("arraybuffer:"),this.dispatch(new Uint8Array(t))},_url:function(t){r("url:"+t.toString())},_map:function(t){r("map:");let i=Array.from(t);this._array(i,!0)},_set:function(t){r("set:");let i=Array.from(t);this._array(i,!0)},_file:function(t){r("file:"),this.dispatch([t.name,t.size,t.type,t.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(t){r("bigint:"+t.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function nt(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}function at(e,n){let r=this[e];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:n}function st(e,n){return typeof n=="string"&&n.startsWith("__raycast_cached_date__")?new Date(n.replace("__raycast_cached_date__","")):typeof n=="string"&&n.startsWith("__raycast_cached_buffer__")?Buffer.from(n.replace("__raycast_cached_buffer__",""),"base64"):n}function ce(e){let n=Ce.default.createHash("sha1");return Re(n).dispatch(e),n.digest("hex")}var ot=Symbol("cache without namespace"),Ee=new Map;function it(e,n,r){let t=r?.cacheNamespace||ot,i=Ee.get(t)||Ee.set(t,new w.Cache({namespace:r?.cacheNamespace})).get(t);if(!i)throw new Error("Missing cache");let c=_(e),s=_(n),a=(0,d.useSyncExternalStore)(i.subscribe,()=>{try{return i.get(c.current)}catch(u){console.error("Could not get Cache data:",u);return}}),o=(0,d.useMemo)(()=>{if(typeof a<"u"){if(a==="undefined")return;try{return JSON.parse(a,st)}catch(u){return console.warn("The cached data is corrupted",u),s.current}}else return s.current},[a,s]),f=_(o),p=(0,d.useCallback)(u=>{let g=typeof u=="function"?u(f.current):u;if(typeof g>"u")i.set(c.current,"undefined");else{let $=JSON.stringify(g,at);i.set(c.current,$)}return g},[i,c,f]);return[o,p]}var te=Symbol();function ge(e,n,r){let{initialData:t,keepPreviousData:i,internal_cacheKeySuffix:c,...s}=r||{},a=(0,d.useRef)(null),[o,f]=it(ce(n||[])+c,te,{cacheNamespace:ce(e)}),p=(0,d.useRef)(o!==te?o:t),u=(0,d.useRef)(void 0),{mutate:g,revalidate:$,...y}=et(e,n||[],{...s,onData(v,k){u.current=k,s.onData&&s.onData(v,k),!(k&&k.page>0)&&(a.current="promise",p.current=v,f(v))}}),b,S=y.pagination;u.current&&u.current.page>0&&y.data?b=y.data:a.current==="promise"?b=p.current:i&&o!==te?(b=o,S&&(S.hasMore=!0,S.pageSize=o.length)):i&&o===te?b=p.current:o!==te?(b=o,S&&(S.hasMore=!0,S.pageSize=o.length)):b=t;let I=_(b),D=(0,d.useCallback)(async(v,k)=>{let P;try{if(k?.optimisticUpdate){typeof k?.rollbackOnError!="function"&&k?.rollbackOnError!==!1&&(P=structuredClone(I.current));let M=k.optimisticUpdate(I.current);a.current="cache",p.current=M,f(M)}return await g(v,{shouldRevalidateAfter:k?.shouldRevalidateAfter})}catch(M){if(typeof k?.rollbackOnError=="function"){let N=k.rollbackOnError(I.current);a.current="cache",p.current=N,f(N)}else k?.optimisticUpdate&&k?.rollbackOnError!==!1&&(a.current="cache",p.current=P,f(P));throw M}},[f,g,I,p,a]);return(0,d.useEffect)(()=>{o!==te&&(a.current="cache",p.current=o)},[o]),{data:b,isLoading:y.isLoading,error:y.error,mutate:u.current&&u.current.page>0?g:D,pagination:S,revalidate:$}}function ct(e){if(e){let n=ut(e);if(!n)return!1;if(n.subtype==="json"||n.suffix==="json"||n.suffix&&/\bjson\b/i.test(n.suffix)||n.subtype&&/\bjson\b/i.test(n.subtype))return!0}return!1}var lt=/^([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126});?$/;function ut(e){let n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim(),t=lt.exec(r.toLowerCase().toLowerCase());if(!t)return;let i=t[1],c=t[2],s,a=c.lastIndexOf("+");return a!==-1&&(s=c.substring(a+1),c=c.substring(0,a)),{type:i,subtype:c,suffix:s}}async function ft(e){if(!e.ok)throw new Error(e.statusText);let n=e.headers.get("content-type");return n&&ct(n)?await e.json():await e.text()}function dt(e){return{data:e,hasMore:!1}}function be(e,n){let{parseResponse:r,mapResult:t,initialData:i,execute:c,keepPreviousData:s,onError:a,onData:o,onWillExecute:f,failureToastOptions:p,...u}=n||{},g={initialData:i,execute:c,keepPreviousData:s,onError:a,onData:o,onWillExecute:f,failureToastOptions:p},$=_(r||ft),y=_(t||dt),b=(0,d.useRef)(null),S=(0,d.useRef)(null),I=typeof e=="function"?e({page:0}):void 0;(!b.current||typeof S.current>"u"||S.current!==I)&&(b.current=e),S.current=I;let D=(0,d.useRef)(null),v=(0,d.useCallback)((M,N)=>async q=>{let Y=await fetch(M(q),{signal:D.current?.signal,...N}),ee=await $.current(Y);return y.current?.(ee)},[$,y]),k=(0,d.useCallback)(async(M,N)=>{let q=await fetch(M,{signal:D.current?.signal,...N}),Y=await $.current(q);return y.current(Y)?.data},[$,y]),P=(0,d.useMemo)(()=>S.current?v:k,[S,k,v]);return ge(P,[b.current,u],{...g,internal_cacheKeySuffix:S.current+ce(y.current)+ce($.current),abortable:D})}var O=require("react");var Ie=require("@raycast/api"),Q=require("fs"),ae=require("path"),Te="https://raw.githubusercontent.com/raycast/extensions/main/extensions",re="#000000CC",ne="#0078D7";function ye(e){if(!e||!e.startsWith("https://www.raycast.com/"))return null;let n=e.replace("https://www.raycast.com/",""),[r,t]=n.split("/");return!r||!t?null:{author:r,extension:t}}function ue(e){let n=ye(e);return n?`raycast://extensions/${n.author}/${n.extension}`:e}function ht(e){for(let i of e.labels){let c=i.name.match(/^extension:\s*(.+)$/i);if(c)return c[1].trim().toLowerCase().replace(/\s+/g,"-")}let n=e.title,r=n.match(/^([^:]+):\s/);if(r){let i=r[1].trim();if(!/^(fix|feat|chore|docs|ci|build|refactor|test|style|perf|revert|bump|update|add|remove|merge)/i.test(i))return i.toLowerCase().replace(/\s+/g,"-")}let t=n.match(/^\[([^\]]+)\]/);return t?t[1].trim().toLowerCase().replace(/\s+/g,"-"):null}async function pt(e){try{let n=await fetch(`https://api.github.com/repos/raycast/extensions/pulls/${e}/files?per_page=10`,{headers:{Accept:"application/vnd.github.v3+json"}});if(!n.ok)return null;let r=await n.json(),t=new Map;for(let s of r){let a=s.filename.match(/^extensions\/([^/]+)\//);if(a){let o=a[1];t.set(o,(t.get(o)??0)+1)}}if(t.size===0)return null;let i="",c=0;for(let[s,a]of t)a>c&&(i=s,c=a);return i||null}catch{return null}}function fe(e){let n=e.split(`
`),r=!1,t=[];for(let i of n){if(i.startsWith("## ")){if(r)break;r=!0,t.push(i);continue}r&&t.push(i)}return t.join(`
`).trim()}async function $e(e){try{let n=await fetch(`${Te}/${e}/package.json`);if(!n.ok)return null;let r=await n.json(),t=r.owner??r.author??e,i=r.title??r.name??e,c=r.name??e,s=r.description??"",a=r.platforms??["macOS"],o=r.version??"",f=(r.categories??[]).filter(u=>typeof u=="string"&&u.trim().length>0),p=r.icon??"";return{owner:t,title:i,name:c,description:s,platforms:a,version:o,categories:f,icon:p}}catch{return null}}function mt(e,n){return n?`${Te}/${e}/${n.startsWith("assets/")?n:`assets/${n}`}`:""}async function Pe(e,n){let r=new Set,t=[],i=[];for(let s of e){if(!s.merged_at)continue;let a=ht(s);if(a){let o=n.get(a);if(o&&new Date(s.merged_at).getTime()<=new Date(o).getTime()||r.has(a))continue;r.add(a),t.push({pr:s,slug:a})}else i.push(s)}if(i.length>0){let s=await Promise.all(i.map(async a=>({pr:a,slug:await pt(a.number)})));for(let{pr:a,slug:o}of s){if(!o)continue;let f=n.get(o);f&&new Date(a.merged_at).getTime()<=new Date(f).getTime()||r.has(o)||(r.add(o),t.push({pr:a,slug:o}))}}return await Promise.all(t.map(async({pr:s,slug:a})=>{let o=await $e(a),f=o?.owner??s.user.login,p=o?.title??a.split("-").map($=>$.charAt(0).toUpperCase()+$.slice(1)).join(" "),u=o?.description??s.title,g=o?.icon?mt(a,o.icon):"";return{id:`pr-${s.number}`,title:p,summary:u,image:g||s.user.avatar_url,date:s.merged_at,authorName:s.user.login,authorUrl:s.user.html_url,url:`https://www.raycast.com/${f}/${a}`,type:"updated",extensionSlug:a,prUrl:s.html_url,platforms:o?.platforms??["macOS"],version:o?.version,categories:o?.categories,extensionIcon:o?.icon}}))}function _e(){let e=new Set;try{let n=Ie.environment.assetsPath,r=(0,ae.dirname)((0,ae.dirname)(n));if(!(0,Q.existsSync)(r))return e;let t=(0,Q.readdirSync)(r,{withFileTypes:!0});for(let i of t){if(!i.isDirectory())continue;let c=(0,ae.join)(r,i.name,"package.json");try{if(!(0,Q.existsSync)(c))continue;let s=(0,Q.readFileSync)(c,"utf-8"),a=JSON.parse(s);a.name&&e.add(a.name)}catch{}}}catch{}return e}var j=require("@raycast/api");var x=require("@raycast/api");var R=require("react/jsx-runtime"),gt={Applications:"#8E44AD",Communication:"#E67E22",Data:"#16A085",Documentation:"#7F8C8D","Design Tools":"#E91E63","Developer Tools":"#2980B9",Finance:"#27AE60",Fun:"#F39C12",Media:"#E74C3C",News:"#3498DB",Productivity:"#9B59B6",Security:"#C0392B",System:"#34495E",Web:"#1ABC9C",Other:"#95A5A6"};function Oe({item:e}){let n=ue(e.url),r=e.platforms?.some(a=>a.toLowerCase()==="macos")??!0,t=e.platforms?.some(a=>a.toLowerCase()==="windows")??!1,i=(e.categories??[]).filter(a=>typeof a=="string"&&a.trim().length>0),c=e.type==="new"?"Published":"Updated",s=new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return(0,R.jsx)(x.List.Item.Detail,{metadata:(0,R.jsxs)(x.List.Item.Detail.Metadata,{children:[(0,R.jsx)(x.List.Item.Detail.Metadata.Label,{title:"Description",text:e.summary}),(0,R.jsx)(x.List.Item.Detail.Metadata.TagList,{title:"Type",children:(0,R.jsx)(x.List.Item.Detail.Metadata.TagList.Item,{text:e.type==="new"?"New":"Update",icon:e.type==="new"?x.Icon.StarCircle:x.Icon.ArrowUpCircle,color:e.type==="new"?x.Color.Green:x.Color.Blue})}),(0,R.jsxs)(x.List.Item.Detail.Metadata.TagList,{title:"Compatibility",children:[r&&(0,R.jsx)(x.List.Item.Detail.Metadata.TagList.Item,{icon:{source:"platform-macos.svg",tintColor:re}}),t&&(0,R.jsx)(x.List.Item.Detail.Metadata.TagList.Item,{icon:{source:"platform-windows.svg",tintColor:ne}})]}),i.length>0&&(0,R.jsx)(x.List.Item.Detail.Metadata.TagList,{title:"Categories",children:i.map(a=>(0,R.jsx)(x.List.Item.Detail.Metadata.TagList.Item,{text:a,color:gt[a]??x.Color.SecondaryText},a))}),(0,R.jsx)(x.List.Item.Detail.Metadata.Separator,{}),(0,R.jsx)(x.List.Item.Detail.Metadata.Label,{title:c,text:s}),e.version&&(0,R.jsx)(x.List.Item.Detail.Metadata.Label,{title:"Version",text:e.version}),e.prUrl&&(0,R.jsx)(x.List.Item.Detail.Metadata.Link,{title:"Pull Request",text:"View PR",target:e.prUrl}),(0,R.jsx)(x.List.Item.Detail.Metadata.Separator,{}),(0,R.jsx)(x.List.Item.Detail.Metadata.Link,{title:"Author",text:e.authorName,target:e.authorUrl}),(0,R.jsx)(x.List.Item.Detail.Metadata.Link,{title:"Store",text:"Open in Raycast Store",target:n})]})})}var m=require("@raycast/api");var bt="https://raw.githubusercontent.com/raycast/extensions/main/extensions";function de(e){let n=e?`${bt}/${e}/CHANGELOG.md`:void 0;return ge(async r=>{let t=await fetch(r);return t.ok?t.text():null},[n],{execute:!!n})}var Le=require("@raycast/api");var C=require("@raycast/api");var V=require("react/jsx-runtime");function Ue({items:e,currentIndex:n,changelog:r}){let{pop:t}=(0,C.useNavigation)();if(!e.length||n<0||n>=e.length)return null;let i=n>0,c=n<e.length-1,s=i?e[n-1]:null,a=c?e[n+1]:null,o=e[n],f=r?fe(r):null;return(0,V.jsxs)(C.ActionPanel,{children:[(0,V.jsxs)(C.ActionPanel.Section,{title:"Navigation",children:[a&&a.extensionSlug&&(0,V.jsx)(C.Action.Push,{title:"Next Changelog",icon:C.Icon.ArrowDown,shortcut:C.Keyboard.Shortcut.Common.MoveDown,target:(0,V.jsx)(he,{slug:a.extensionSlug,title:a.title,items:e,currentIndex:n+1})}),s&&s.extensionSlug&&(0,V.jsx)(C.Action,{title:"Previous Changelog",icon:C.Icon.ArrowUp,shortcut:C.Keyboard.Shortcut.Common.MoveUp,onAction:t})]}),(0,V.jsxs)(C.ActionPanel.Section,{children:[f&&(0,V.jsx)(C.Action.CopyToClipboard,{title:"Copy Recent Changes",content:f,icon:C.Icon.Clipboard,shortcut:C.Keyboard.Shortcut.Common.Copy}),(0,V.jsx)(C.Action.OpenInBrowser,{title:"Open in Browser",url:o.url,icon:C.Icon.Globe,shortcut:C.Keyboard.Shortcut.Common.Open})]})]})}var we=require("react/jsx-runtime");function he({slug:e,title:n,items:r,currentIndex:t}){let{data:i,isLoading:c}=de(e),s=i??`# ${n}

No changelog available for this extension.`;return(0,we.jsx)(Le.Detail,{isLoading:c,markdown:s,navigationTitle:`${n} \u2014 Changelog`,actions:(0,we.jsx)(Ue,{items:r,currentIndex:t,changelog:i})})}var A=require("react/jsx-runtime"),yt="https://github.com/raycast/extensions/blob/main/extensions";function De({item:e,items:n,currentIndex:r,trackReadStatus:t,toggles:i,onToggleMacOS:c,onToggleWindows:s,onMarkAsRead:a,onMarkAllAsRead:o,onUndo:f,onRefresh:p,isRefreshing:u}){let g=ue(e.url),$=e.extensionSlug?`${yt}/${e.extensionSlug}/CHANGELOG.md`:void 0,{data:y}=de(e.extensionSlug),b=y?fe(y):null;return(0,A.jsxs)(m.ActionPanel,{children:[e.extensionSlug&&(0,A.jsxs)(m.ActionPanel.Section,{title:"Changelog",children:[(0,A.jsx)(m.Action.Push,{title:"View Changelog",icon:m.Icon.Document,target:(0,A.jsx)(he,{slug:e.extensionSlug,title:e.title,items:n,currentIndex:r})}),b&&(0,A.jsx)(m.Action.CopyToClipboard,{title:"Copy Recent Changes",content:b,icon:m.Icon.Clipboard,shortcut:m.Keyboard.Shortcut.Common.Copy}),$&&(0,A.jsx)(m.Action.OpenInBrowser,{title:"Open Changelog in Browser",url:$,icon:m.Icon.Globe,shortcut:{modifiers:["cmd","shift"],key:"l"}})]}),(0,A.jsx)(m.Action.OpenInBrowser,{title:"Open in Browser",url:e.url,icon:m.Icon.Globe,shortcut:m.Keyboard.Shortcut.Common.Open}),(0,A.jsxs)(m.ActionPanel.Section,{children:[(0,A.jsx)(m.Action.OpenInBrowser,{title:"Open in Raycast Store",url:g,icon:m.Icon.RaycastLogoNeg}),(0,A.jsx)(m.Action.CopyToClipboard,{title:"Copy Extension URL",content:e.url,shortcut:{modifiers:["cmd","shift"],key:"c"}})]}),(0,A.jsx)(m.ActionPanel.Section,{children:(0,A.jsx)(m.Action,{title:u?"Refreshing\u2026":"Refresh",icon:m.Icon.ArrowClockwise,shortcut:m.Keyboard.Shortcut.Common.Refresh,onAction:()=>!u&&p?.()})}),(0,A.jsxs)(m.ActionPanel.Section,{title:"Filters",children:[(0,A.jsx)(m.Action,{title:i.showMacOS?"Hide macOS-only Extensions":"Show macOS-only Extensions",icon:{source:"platform-macos.svg",tintColor:re},onAction:c}),(0,A.jsx)(m.Action,{title:i.showWindows?"Hide Windows-only Extensions":"Show Windows-only Extensions",icon:{source:"platform-windows.svg",tintColor:ne},onAction:s})]}),t&&(0,A.jsxs)(m.ActionPanel.Section,{title:"Read Status",children:[(0,A.jsx)(m.Action,{title:"Mark as Read",icon:m.Icon.CheckCircle,shortcut:{modifiers:["cmd","shift"],key:"r"},onAction:()=>a?.(e.id)}),o&&(0,A.jsx)(m.Action,{title:"Mark All as Read",icon:m.Icon.CheckRosette,shortcut:{modifiers:["cmd","shift"],key:"a"},onAction:o}),f&&(0,A.jsx)(m.Action,{title:"Undo",icon:m.Icon.Undo,shortcut:{modifiers:["cmd"],key:"z"},onAction:f})]})]})}var pe=require("react/jsx-runtime");function Me({item:e,items:n,currentIndex:r,filter:t,trackReadStatus:i,toggles:c,onToggleMacOS:s,onToggleWindows:a,onMarkAsRead:o,onMarkAllAsRead:f,onUndo:p,onRefresh:u,isRefreshing:g}){let $=t==="all",y=[],b=e.platforms?.some(I=>I.toLowerCase()==="macos")??!0,S=e.platforms?.some(I=>I.toLowerCase()==="windows")??!1;return b&&y.push({icon:{source:"platform-macos.svg",tintColor:re},tooltip:"macOS"}),S&&y.push({icon:{source:"platform-windows.svg",tintColor:ne},tooltip:"Windows"}),$&&y.push({icon:{source:e.type==="new"?j.Icon.StarCircle:j.Icon.ArrowUpCircle,tintColor:e.type==="new"?j.Color.Green:j.Color.Blue},tooltip:e.type==="new"?"New Extension":"Updated Extension"}),(0,pe.jsx)(j.List.Item,{icon:{source:e.image,fallback:j.Icon.Box},title:e.title,accessories:y,detail:(0,pe.jsx)(Oe,{item:e}),actions:(0,pe.jsx)(De,{item:e,items:n,currentIndex:r,trackReadStatus:i,toggles:c,onToggleMacOS:s,onToggleWindows:a,onMarkAsRead:o,onMarkAllAsRead:f,onUndo:p,onRefresh:u,isRefreshing:g})})}var L=require("@raycast/api"),U=require("react"),We="read-items";function Ne(e){let[n,r]=(0,U.useState)(new Set),[t,i]=(0,U.useState)(!1),c=(0,U.useRef)(null);(0,U.useEffect)(()=>{e&&L.LocalStorage.getItem(We).then(u=>{if(u)try{let g=JSON.parse(u);r(new Set(g))}catch{}i(!0)})},[e]);let s=(0,U.useCallback)(async u=>{await L.LocalStorage.setItem(We,JSON.stringify([...u]))},[]),a=(0,U.useCallback)(u=>e?n.has(u):!1,[e,n]),o=(0,U.useCallback)(async u=>{if(!e)return;c.current={type:"markOne",itemIds:[u]};let g=new Set(n);g.add(u),r(g),await s(g),await(0,L.showToast)({style:L.Toast.Style.Success,title:"Marked as Read",message:"Press \u2318Z to undo"})},[e,n,s]),f=(0,U.useCallback)(async u=>{if(!e)return;let g=u.filter(y=>!n.has(y));c.current={type:"markAll",itemIds:g};let $=new Set(n);for(let y of u)$.add(y);r($),await s($),await(0,L.showToast)({style:L.Toast.Style.Success,title:`Marked ${g.length} Items as Read`,message:"Press \u2318Z to undo"})},[e,n,s]),p=(0,U.useCallback)(async()=>{if(!e||!c.current){await(0,L.showToast)({style:L.Toast.Style.Failure,title:"Nothing to Undo"});return}let u=c.current;c.current=null;let g=new Set(n);for(let y of u.itemIds)g.delete(y);r(g),await s(g);let $=u.itemIds.length;await(0,L.showToast)({style:L.Toast.Style.Success,title:$===1?"Unmarked as Read":`Unmarked ${$} Items as Read`})},[e,n,s]);return{isRead:a,markAsRead:o,markAllAsRead:f,undo:p,loaded:t}}var G=require("@raycast/api"),B=require("react"),Fe="filter-toggles",Ve={showMacOS:!0,showWindows:!0};function ze(){let[e,n]=(0,B.useState)(Ve),[r,t]=(0,B.useState)(!1);(0,B.useEffect)(()=>{G.LocalStorage.getItem(Fe).then(a=>{if(a)try{let o=JSON.parse(a);n({...Ve,...o})}catch{}t(!0)})},[]);let i=(0,B.useCallback)(async a=>{await G.LocalStorage.setItem(Fe,JSON.stringify(a))},[]),c=(0,B.useCallback)(async()=>{n(a=>{let o={...a,showMacOS:!a.showMacOS};return!o.showMacOS&&!o.showWindows&&(o.showWindows=!0),i(o),(0,G.showToast)({style:G.Toast.Style.Success,title:o.showMacOS?"Showing macOS-only extensions":"Hiding macOS-only extensions"}),o})},[i]),s=(0,B.useCallback)(async()=>{n(a=>{let o={...a,showWindows:!a.showWindows};return!o.showWindows&&!o.showMacOS&&(o.showMacOS=!0),i(o),(0,G.showToast)({style:G.Toast.Style.Success,title:o.showWindows?"Showing Windows-only extensions":"Hiding Windows-only extensions"}),o})},[i]);return{toggles:e,loaded:r,toggleMacOS:c,toggleWindows:s}}var z=require("react/jsx-runtime"),$t="https://www.raycast.com/store/feed.json",wt="https://api.github.com/repos/raycast/extensions/pulls?state=closed&sort=updated&direction=desc&per_page=50",je=1e4;function Be(){let{trackReadStatus:e}=(0,E.getPreferenceValues)(),[n,r]=(0,O.useState)("all"),{toggles:t,toggleMacOS:i,toggleWindows:c}=ze(),{data:s,isLoading:a,revalidate:o}=be($t,{keepPreviousData:!0}),{data:f,isLoading:p,revalidate:u}=be(wt,{keepPreviousData:!0,headers:{Accept:"application/vnd.github.v3+json"}}),[g,$]=(0,O.useState)(0),[y,b]=(0,O.useState)(!1),S=async()=>{let l=Date.now(),h=l-g;if(h<je){let W=Math.ceil((je-h)/1e3);await(0,E.showToast)({style:E.Toast.Style.Failure,title:"Please wait before refreshing",message:`Try again in ${W} second${W!==1?"s":""}`});return}b(!0),$(l),o(),u(),await(0,E.showToast)({style:E.Toast.Style.Success,title:"Feed refreshed"}),b(!1)},I=a||p,D=(0,O.useMemo)(()=>n!=="my-updates"?null:_e(),[n]),[v,k]=(0,O.useState)([]),[P,M]=(0,O.useState)([]),{isRead:N,markAsRead:q,markAllAsRead:Y,undo:ee}=Ne(e);(0,O.useEffect)(()=>{if(!s)return;let l=s.items??[];Promise.all(l.map(async h=>{let W=ye(h.url);if(!W)return null;let{extension:J}=W,Z=await $e(J);return{id:h.id,title:h.title,summary:h.summary,image:h.image,date:h.date_modified,authorName:h.author.name,authorUrl:h.author.url,url:h.url,type:"new",extensionSlug:J,platforms:Z?.platforms??["macOS"],version:Z?.version,categories:Z?.categories,extensionIcon:Z?.icon}})).then(h=>M(h.filter(W=>W!==null)))},[s]),(0,O.useEffect)(()=>{if(!f)return;let l=new Map;for(let h of P)h.extensionSlug&&l.set(h.extensionSlug,h.date);Pe(f,l).then(k)},[f,P]);let F=(0,O.useMemo)(()=>[...P,...v].sort((l,h)=>new Date(h.date).getTime()-new Date(l.date).getTime()),[P,v]),T=(0,O.useMemo)(()=>{let l;switch(n){case"new":l=P;break;case"updated":l=v;break;case"my-updates":l=D?v.filter(h=>h.extensionSlug?D.has(h.extensionSlug):!1):[];break;default:l=F}return l=l.filter(h=>{let W=h.platforms??["macOS"],J=W.some(me=>me.toLowerCase()==="macos"),Z=W.some(me=>me.toLowerCase()==="windows");return J&&Z?!0:!(!t.showMacOS&&J&&!Z||!t.showWindows&&Z&&!J)}),e&&(l=l.filter(h=>!N(h.id))),l},[n,P,v,F,t,D,e,N]),H=async()=>{await Y(T.map(l=>l.id))},K=(0,O.useMemo)(()=>t.showMacOS&&!t.showWindows?"Search macOS-only extensions...":t.showWindows&&!t.showMacOS?"Search Windows-only extensions...":"Search extensions...",[t.showMacOS,t.showWindows]);return(0,z.jsx)(E.List,{isLoading:I,isShowingDetail:!0,searchBarPlaceholder:K,searchBarAccessory:(0,z.jsxs)(E.List.Dropdown,{tooltip:"Filter",storeValue:!0,onChange:l=>r(l),children:[(0,z.jsx)(E.List.Dropdown.Item,{title:"Show All",value:"all",icon:E.Icon.AppWindowGrid3x3}),(0,z.jsx)(E.List.Dropdown.Item,{title:"New",value:"new",icon:E.Icon.StarCircle}),(0,z.jsx)(E.List.Dropdown.Item,{title:"Updates",value:"updated",icon:E.Icon.ArrowUpCircle}),(0,z.jsx)(E.List.Dropdown.Item,{title:"My Updates",value:"my-updates",icon:E.Icon.Person})]}),children:T.length===0&&!I?(0,z.jsx)(E.List.EmptyView,{icon:E.Icon.MagnifyingGlass,title:e?"All Caught Up!":"No Extensions Found",description:e?"All items have been marked as read":n==="all"?"Unable to load the feed":n==="my-updates"?"No updates found for your installed extensions":`No ${n} extensions found`}):T.map((l,h)=>(0,z.jsx)(Me,{item:l,items:T,currentIndex:h,filter:n,trackReadStatus:e,toggles:t,onToggleMacOS:i,onToggleWindows:c,onMarkAsRead:q,onMarkAllAsRead:H,onUndo:ee,onRefresh:S,isRefreshing:y},l.id))})}
